<?xml version="1.0" encoding="UTF-8"?>

    <community ID="yes" POSTDATE="<%=Date.today%>" xmlns="" COMPANY="United Property Management">
      <%(Property.building_names).each do |x| %>
      <units>
      <% Property.available_per_prop(x).each do |property| %>
        <unit ID="<%=x%>" AVAILDATE="<%= property.move_out != nil ? property.move_out.next_day(5) : DateTime.now %>" STATUS="On Notice" UNITTYPE="property.unit_type.unit_type" UNITCAT="11" AMENITYVALUE="0.00">
          <% PropertyName.all[Property.building_names.index(x)].lease_terms.split(",").map{ |i| i.to_i}.each do |month| %>
            <% if property.group ==   "Vacant Unrented Not Ready" ||  "Vacant Unrented Ready" %>
              <offeredterm LT="<%=month%>" BASERENT="0.00" TOTALCONCESSION="0.00" EFFECTIVERENT="<%= number_to_currency @bed_premiums_per_building[x].calculate_rent0(((property.unit_rent * ( 1.0 + ((property.move_out.year * 12.0 + property.move_out.month ) - (property.unit_type.market_rate_date.year * 12.0 + property.unit_type.market_rate_date.month)) / 12.0 * property.unit_type.growth_rate)) - property.unit_type.amount_off - ( property.unit_rent * property.unit_type.percentage_off) ), property.unit_type.bedroom.to_i, month), precision: 0 %>" CONTYPE="T" CONVALUE="0.00"/>
            <% elsif property.group == "Notice Unrented"  %>
              <% if property.move_out.next_day(5).strftime("%Y%m") <= DateTime.now.strftime("%Y%m") %>
                <offeredterm LT="<%=month%>" BASERENT="0.00" TOTALCONCESSION="0.00" EFFECTIVERENT="<%= number_to_currency @bed_premiums_per_building[x].calculate_rent0(((property.unit_rent * ( 1.0 + ((property.move_out.year * 12.0 + property.move_out.month ) - (property.unit_type.market_rate_date.year * 12.0 + property.unit_type.market_rate_date.month)) / 12.0 * property.unit_type.growth_rate)) - property.unit_type.amount_off - ( property.unit_rent * property.unit_type.percentage_off) ), property.unit_type.bedroom.to_i, month), precision: 0 %>" CONTYPE="T" CONVALUE="0.00"/>
              <% elsif property.move_out.next_day(5).strftime("%Y%m") == DateTime.now.next_month(1).strftime("%Y%m") %>
                <offeredterm LT="<%=month%>" BASERENT="0.00" TOTALCONCESSION="0.00" EFFECTIVERENT="<%= number_to_currency @bed_premiums_per_building[x].calculate_rent1(((property.unit_rent * ( 1.0 + ((property.move_out.year * 12.0 + property.move_out.month ) - (property.unit_type.market_rate_date.year * 12.0 + property.unit_type.market_rate_date.month)) / 12.0 * property.unit_type.growth_rate)) - property.unit_type.amount_off - ( property.unit_rent * property.unit_type.percentage_off) ), property.unit_type.bedroom.to_i, month), precision: 0 %>" CONTYPE="T" CONVALUE="0.00"/>
              <% elsif property.move_out.next_day(5).strftime("%Y%m") == DateTime.now.next_month(2).strftime("%Y%m") %>
                <offeredterm LT="<%=month%>" BASERENT="0.00" TOTALCONCESSION="0.00" EFFECTIVERENT="<%= number_to_currency @bed_premiums_per_building[x].calculate_rent2(((property.unit_rent * ( 1.0 + ((property.move_out.year * 12.0 + property.move_out.month ) - (property.unit_type.market_rate_date.year * 12.0 + property.unit_type.market_rate_date.month)) / 12.0 * property.unit_type.growth_rate)) - property.unit_type.amount_off - ( property.unit_rent * property.unit_type.percentage_off) ), property.unit_type.bedroom.to_i, month), precision: 0 %>" CONTYPE="T" CONVALUE="0.00"/>
              <% elsif property.move_out.next_day(5).strftime("%Y%m") == DateTime.now.next_month(3).strftime("%Y%m") %>
                <offeredterm LT="<%=month%>" BASERENT="0.00" TOTALCONCESSION="0.00" EFFECTIVERENT="<%= number_to_currency @bed_premiums_per_building[x].calculate_rent3(((property.unit_rent * ( 1.0 + ((property.move_out.year * 12.0 + property.move_out.month ) - (property.unit_type.market_rate_date.year * 12.0 + property.unit_type.market_rate_date.month)) / 12.0 * property.unit_type.growth_rate)) - property.unit_type.amount_off - ( property.unit_rent * property.unit_type.percentage_off) ), property.unit_type.bedroom.to_i, month), precision: 0 %>" CONTYPE="T" CONVALUE="0.00"/>
              <% elsif property.move_out.next_day(5).strftime("%Y%m") == DateTime.now.next_month(4).strftime("%Y%m") %>
                <offeredterm LT="<%=month%>" BASERENT="0.00" TOTALCONCESSION="0.00" EFFECTIVERENT="<%= number_to_currency @bed_premiums_per_building[x].calculate_rent4(((property.unit_rent * ( 1.0 + ((property.move_out.year * 12.0 + property.move_out.month ) - (property.unit_type.market_rate_date.year * 12.0 + property.unit_type.market_rate_date.month)) / 12.0 * property.unit_type.growth_rate)) - property.unit_type.amount_off - ( property.unit_rent * property.unit_type.percentage_off) ), property.unit_type.bedroom.to_i, month), precision: 0 %>" CONTYPE="T" CONVALUE="0.00"/>
              <% elsif property.move_out.next_day(5).strftime("%Y%m") == DateTime.now.next_month(5).strftime("%Y%m") %>
                <offeredterm LT="<%=month%>" BASERENT="0.00" TOTALCONCESSION="0.00" EFFECTIVERENT="<%= number_to_currency @bed_premiums_per_building[x].calculate_rent5(((property.unit_rent * ( 1.0 + ((property.move_out.year * 12.0 + property.move_out.month ) - (property.unit_type.market_rate_date.year * 12.0 + property.unit_type.market_rate_date.month)) / 12.0 * property.unit_type.growth_rate)) - property.unit_type.amount_off - ( property.unit_rent * property.unit_type.percentage_off) ), property.unit_type.bedroom.to_i, month), precision: 0 %>" CONTYPE="T" CONVALUE="0.00"/>
              <%end%>
            <%end%>
          <%end%>
        </unit>
      <%end%>
      </units>
    <%end%>
    </community>
