<?xml version="1.0" encoding="UTF-8"?>
<% Property.building_names.each do |name| %>
  <Community ID="<%= name %>" POSTDATE="today" xmlns="" COMPANY="United Property Management">
    <units>
    <% Property.available.each do |property| %>
      <unit ID="<%=property.unit%>" AVAILDATE="20140110" STATUS="<%=property.group%>" UNITTYPE="<%=property.unit_type.unit_type%>" UNITCAT="11" AMENITYVALUE="0.00">
      <% if property.group ==   "Vacant Unrented Not Ready" ||  "Vacant Unrented Ready"%>
        <%PropertyName.all[Property.building_names.index(name)].lease_terms.split(",").map{ |i| i.to_i}.each do |month|%>
          <offeredterm 1LT="<%= month %>" BASERENT="" TOTALCONCESSION ="" EFFECTIVERENT="<%=number_to_currency @bed_premiums_per_building[name].calculate_rent0(((property.unit_rent * ( 1.0 + ((property.move_out.year * 12.0 + property.move_out.month ) - (property.unit_type.market_rate_date.year * 12.0 + property.unit_type.market_rate_date.month)) / 12.0 * property.unit_type.growth_rate)) - property.unit_type.amount_off - ( property.unit_rent * property.unit_type.percentage_off) ), property.unit_type.bedroom.to_i, month), precision: 0 %>"  CONTYPE="T" CONVALUE="0.00"/>
        <%end%>
      </unit>
      <% elsif property.group == "Notice Unrented"  %>
        <% if property.move_out.next_day(5).strftime("%Y%m") <= DateTime.now.strftime("%Y%m") %>
          <%PropertyName.all[Property.building_names.index(name)].lease_terms.split(",").map{ |i| i.to_i}.each do |month|%>
            <offeredterm LT="<%= month %>" BASERENT="" TOTALCONCESSION = "" EFFECTIVERENT="<%= number_to_currency @bed_premiums_per_building[name].calculate_rent0(((property.unit_rent * ( 1.0 + ((property.move_out.year * 12.0 + property.move_out.month ) - (property.unit_type.market_rate_date.year * 12.0 + property.unit_type.market_rate_date.month)) / 12.0 * property.unit_type.growth_rate)) - property.unit_type.amount_off - ( property.unit_rent * property.unit_type.percentage_off) ), property.unit_type.bedroom.to_i, month), precision: 0 %>"  CONTYPE="T" CONVALUE="0.00"/>
          <%end%>
      </unit>
        <% elsif property.move_out.next_day(5).strftime("%Y%m") == DateTime.now.next_month(1).strftime("%Y%m") %>
          <%PropertyName.all[Property.building_names.index(name)].lease_terms.split(",").map{ |i| i.to_i}.each do |month|%>
            <offeredterm LT="<%= month %>" BASERENT="" TOTALCONCESSION = "" EFFECTIVERENT="<%= number_to_currency @bed_premiums_per_building[name].calculate_rent1(((property.unit_rent * ( 1.0 + ((property.move_out.year * 12.0 + property.move_out.month ) - (property.unit_type.market_rate_date.year * 12.0 + property.unit_type.market_rate_date.month)) / 12.0 * property.unit_type.growth_rate)) - property.unit_type.amount_off - ( property.unit_rent * property.unit_type.percentage_off) ), property.unit_type.bedroom.to_i, month), precision: 0 %>"  CONTYPE="T" CONVALUE="0.00"/>
          <%end%>
      </unit>
        <% elsif property.move_out.next_day(5).strftime("%Y%m") == DateTime.now.next_month(2).strftime("%Y%m") %>
          <%PropertyName.all[Property.building_names.index(name)].lease_terms.split(",").map{ |i| i.to_i}.each do |month|%>
            <offeredterm LT="<%= month %>" BASERENT="" TOTALCONCESSION = "" EFFECTIVERENT="<%= number_to_currency @bed_premiums_per_building[name].calculate_rent2(((property.unit_rent * ( 1.0 + ((property.move_out.year * 12.0 + property.move_out.month ) - (property.unit_type.market_rate_date.year * 12.0 + property.unit_type.market_rate_date.month)) / 12.0 * property.unit_type.growth_rate)) - property.unit_type.amount_off - ( property.unit_rent * property.unit_type.percentage_off) ), property.unit_type.bedroom.to_i, month), precision: 0 %>"  CONTYPE="T" CONVALUE="0.00"/>
          <%end%>
      </unit>
        <% elsif property.move_out.next_day(5).strftime("%Y%m") == DateTime.now.next_month(3).strftime("%Y%m") %>
                <%PropertyName.all[Property.building_names.index(name)].lease_terms.split(",").map{ |i| i.to_i}.each do |month|%>
                  <offeredterm LT="<%= month %>" BASERENT="" TOTALCONCESSION = "" EFFECTIVERENT="<%= number_to_currency @bed_premiums_per_building[name].calculate_rent3(((property.unit_rent * ( 1.0 + ((property.move_out.year * 12.0 + property.move_out.month ) - (property.unit_type.market_rate_date.year * 12.0 + property.unit_type.market_rate_date.month)) / 12.0 * property.unit_type.growth_rate)) - property.unit_type.amount_off - ( property.unit_rent * property.unit_type.percentage_off) ), property.unit_type.bedroom.to_i, month), precision: 0 %>"  CONTYPE="T" CONVALUE="0.00"/>
                <%end%>
      </unit>
        <% elsif property.move_out.next_day(5).strftime("%Y%m") == DateTime.now.next_month(4).strftime("%Y%m") %>
                <%PropertyName.all[Property.building_names.index(name)].lease_terms.split(",").map{ |i| i.to_i}.each do |month|%>
                  <offeredterm LT="<%= month %>" BASERENT="" TOTALCONCESSION = "" EFFECTIVERENT="<%= number_to_currency @bed_premiums_per_building[name].calculate_rent4(((property.unit_rent * ( 1.0 + ((property.move_out.year * 12.0 + property.move_out.month ) - (property.unit_type.market_rate_date.year * 12.0 + property.unit_type.market_rate_date.month)) / 12.0 * property.unit_type.growth_rate)) - property.unit_type.amount_off - ( property.unit_rent * property.unit_type.percentage_off) ), property.unit_type.bedroom.to_i, month), precision: 0 %>"  CONTYPE="T" CONVALUE="0.00"/>
                <%end%>
      </unit>
        <% elsif property.move_out.next_day(5).strftime("%Y%m") == DateTime.now.next_month(5).strftime("%Y%m") %>
                <%PropertyName.all[Property.building_names.index(name)].lease_terms.split(",").map{ |i| i.to_i}.each do |month|%>
                  <offeredterm LT="<%= month %>" BASERENT="" TOTALCONCESSION = "" EFFECTIVERENT="<%= number_to_currency @bed_premiums_per_building[name].calculate_rent5(((property.unit_rent * ( 1.0 + ((property.move_out.year * 12.0 + property.move_out.month ) - (property.unit_type.market_rate_date.year * 12.0 + property.unit_type.market_rate_date.month)) / 12.0 * property.unit_type.growth_rate)) - property.unit_type.amount_off - ( property.unit_rent * property.unit_type.percentage_off) ), property.unit_type.bedroom.to_i, month), precision: 0 %>"  CONTYPE="T" CONVALUE="0.00"/>
                <%end%>
      </unit>
              <%end%>
            <%end%>

          <%end%>


    </units>
  </Community>
<%end%>
