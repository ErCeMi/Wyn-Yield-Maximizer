<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>
    <%(Property.building_names).each do |x| %>
      <table class="<%=x%> class=centered highlight responsive-table testclass">
        <thead>
          <tr>
            <th>Name</th>
            <th>Unit</th>
            <th>Unit Type</th>
            <th>Group</th>
            <th>lease to </th>
            <th width="20%">Amenity</th>
            <th> Resident </th>
            <th> Going Price </th>
            <th>Current Rent</th>
            <% PropertyName.all[Property.building_names.index(x)].lease_terms.split(",").map{ |i| i.to_i}.each do |month| %>
              <th><%= month %> mo.</th>
            <% end %>
          </tr>
        </thead>
        <tbody>
          <% Property.renewing_per_prop(x).sort_by{|k| k.move_out || DateTime.now.next_month(12) }.each do |property| %>
            <tr>
              <td><%= x %></td>
              <td><%= property.unit %></td>
              <td><%= property.unit_type.unit_type %></td>
              <td><%= property.group %></td>
              <th><%= property.lease_to %></td>
              <td><%= property.amenities %></td>
              <td><%= property.resident_name %> </td>
              <td><%= (property.unit_rent - property.unit_type.amount_off) %> </td>
              <td><%= property.resident_rent %></td>
              <% if property.resident_rent + property.unit_type.increase_amount >= (property.unit_rent - property.unit_type.amount_off) %>
                <% if property.lease_to.strftime("%Y%m") <= DateTime.now.strftime("%Y%m") %>
                  <% PropertyName.all[Property.building_names.index(x)].lease_terms.split(",").map{ |i| i.to_i}.each do |month| %>
                    <th><%= number_to_currency @bed_premiums_per_building[x].calculate_rent0((property.resident_rent), property.unit_type.bedroom.to_i, month), precision: 0 %></th>
                  <% end %>
                <% elsif property.lease_to.strftime("%Y%m") == DateTime.now.next_month(1).strftime("%Y%m") %>
                  <% PropertyName.all[Property.building_names.index(x)].lease_terms.split(",").map{ |i| i.to_i}.each do |month| %>
                    <th><%= number_to_currency @bed_premiums_per_building[x].calculate_rent1((property.resident_rent), property.unit_type.bedroom.to_i, month), precision: 0 %></th>
                  <% end %>
                <% elsif property.lease_to.strftime("%Y%m") == DateTime.now.next_month(2).strftime("%Y%m") %>
                  <% PropertyName.all[Property.building_names.index(x)].lease_terms.split(",").map{ |i| i.to_i}.each do |month| %>
                    <th><%= number_to_currency @bed_premiums_per_building[x].calculate_rent2((property.resident_rent), property.unit_type.bedroom.to_i, month), precision: 0 %></th>
                  <% end %>
                <% elsif property.lease_to.strftime("%Y%m") == DateTime.now.next_month(3).strftime("%Y%m") %>
                  <% PropertyName.all[Property.building_names.index(x)].lease_terms.split(",").map{ |i| i.to_i}.each do |month| %>
                    <th><%= number_to_currency @bed_premiums_per_building[x].calculate_rent3((property.resident_rent), property.unit_type.bedroom.to_i, month), precision: 0 %></th>
                  <% end %>
                <% elsif property.lease_to.strftime("%Y%m") == DateTime.now.next_month(4).strftime("%Y%m") %>
                  <% PropertyName.all[Property.building_names.index(x)].lease_terms.split(",").map{ |i| i.to_i}.each do |month| %>
                    <th><%= number_to_currency @bed_premiums_per_building[x].calculate_rent4((property.resident_rent), property.unit_type.bedroom.to_i, month), precision: 0 %></th>
                  <% end %>
                <% end %>
              <% else %>
                <% if property.lease_to.strftime("%Y%m") <= DateTime.now.strftime("%Y%m") %>
                  <% PropertyName.all[Property.building_names.index(x)].lease_terms.split(",").map{ |i| i.to_i}.each do |month| %>
                    <th><%= number_to_currency @bed_premiums_per_building[x].calculate_rent0((property.resident_rent + property.unit_type.increase_amount), property.unit_type.bedroom.to_i, month), precision: 0 %></th>
                  <% end %>
                <% elsif property.lease_to.strftime("%Y%m") == DateTime.now.next_month(1).strftime("%Y%m") %>
                  <% PropertyName.all[Property.building_names.index(x)].lease_terms.split(",").map{ |i| i.to_i}.each do |month| %>
                    <th><%= number_to_currency @bed_premiums_per_building[x].calculate_rent1((property.resident_rent + property.unit_type.increase_amount), property.unit_type.bedroom.to_i, month), precision: 0 %></th>
                  <% end %>
                <% elsif property.lease_to.strftime("%Y%m") == DateTime.now.next_month(2).strftime("%Y%m") %>
                  <% PropertyName.all[Property.building_names.index(x)].lease_terms.split(",").map{ |i| i.to_i}.each do |month| %>
                    <th><%= number_to_currency @bed_premiums_per_building[x].calculate_rent2((property.resident_rent + property.unit_type.increase_amount), property.unit_type.bedroom.to_i, month), precision: 0 %></th>
                  <% end %>
                <% elsif property.lease_to.strftime("%Y%m") == DateTime.now.next_month(3).strftime("%Y%m") %>
                  <% PropertyName.all[Property.building_names.index(x)].lease_terms.split(",").map{ |i| i.to_i}.each do |month| %>
                    <th><%= number_to_currency @bed_premiums_per_building[x].calculate_rent3((property.resident_rent + property.unit_type.increase_amount), property.unit_type.bedroom.to_i, month), precision: 0 %></th>
                  <% end %>
                <% elsif property.lease_to.strftime("%Y%m") == DateTime.now.next_month(4).strftime("%Y%m") %>
                  <% PropertyName.all[Property.building_names.index(x)].lease_terms.split(",").map{ |i| i.to_i}.each do |month| %>
                    <th><%= number_to_currency @bed_premiums_per_building[x].calculate_rent4((property.resident_rent + property.unit_type.increase_amount), property.unit_type.bedroom, month), precision: 0 %></th>
                  <% end %>
                <%end %>
            <%end %>
            </tr>
          <% end %>
        </tbody>
      </table>
      <% end %>
    </br>
      </div>
      </div>
  </body>
</html>
